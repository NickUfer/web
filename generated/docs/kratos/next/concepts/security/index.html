<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-71865250-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="ORY Kratos" href="/kratos/docs/opensearch.xml"><title data-react-helmet="true">Threat Models and Security Profiles | ORY Kratos</title><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Threat Models and Security Profiles | ORY Kratos"><meta data-react-helmet="true" name="description" content="Please be aware that this chapter is still work in progress. Not all mitigation"><meta data-react-helmet="true" property="og:description" content="Please be aware that this chapter is still work in progress. Not all mitigation"><meta data-react-helmet="true" property="og:url" content="https://www.ory.sh//kratos/docs/next/concepts/security"><link data-react-helmet="true" rel="shortcut icon" href="/kratos/docs/img/favico.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://www.ory.sh//kratos/docs/next/concepts/security"><link rel="stylesheet" href="/kratos/docs/styles.01785075.css">
<link rel="preload" href="/kratos/docs/styles.3afafc58.js" as="script">
<link rel="preload" href="/kratos/docs/runtime~main.78d25836.js" as="script">
<link rel="preload" href="/kratos/docs/main.350481f8.js" as="script">
<link rel="preload" href="/kratos/docs/2.5656020f.js" as="script">
<link rel="preload" href="/kratos/docs/3.2e356fd4.js" as="script">
<link rel="preload" href="/kratos/docs/1be78505.78c61d1d.js" as="script">
<link rel="preload" href="/kratos/docs/b8d7c5e6.335c2cf6.js" as="script">
<link rel="preload" href="/kratos/docs/367.30d1c7e4.js" as="script">
<link rel="preload" href="/kratos/docs/366.974e634b.js" as="script">
<link rel="preload" href="/kratos/docs/935f2afb.ddb06975.js" as="script">
<link rel="preload" href="/kratos/docs/17896441.27be24ed.js" as="script">
<link rel="preload" href="/kratos/docs/a34feefc.b1d9beaa.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img class="navbar__logo" src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos"><strong class="navbar__title"></strong></a><a class="navbar__item navbar__link" href="/kratos/docs/">Docs</a><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Ecosystem</a><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://community.ory.sh" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Forum</a><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chat</a><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/kratos/docs/versions">v0.5</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img class="navbar__logo" src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/">Docs</a></li><li class="menu__list-item"><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="menu__link">Ecosystem</a></li><li class="menu__list-item"><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://community.ory.sh" target="_blank" rel="noopener noreferrer" class="menu__link">Forum</a></li><li class="menu__list-item"><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="menu__link">Chat</a></li><li class="menu__list-item"><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/versions">v0.5</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/configuring">Configuring</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/index">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/terminology">Terminology</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/ui-user-interface">User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/identity-data-model">Identity Data Model</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Identity Credentials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/credentials">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/credentials/username-email-password">Username / Email &amp; Password</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">Social Sign In, OpenID Connect, and OAuth2</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/browser-redirect-flow-completion">HTTP Redirection Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/rest-api">REST API Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/concepts/federation">Federation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/kratos/docs/next/concepts/security">Threat Models and Security Profiles</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Self Service (End-User)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service">Concepts and Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-registration">User Registration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-login">User Login</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-settings">User Settings and Profile Updates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/account-recovery">Account Recovery and Password Reset</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/verify-email-account-activation">Email and Phone Verification and Account Activation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-logout">User Logout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-facing-errors">User-Facing Errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/2fa-mfa-multi-factor-authentication">MFA / 2FA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/hooks">Hooks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/admin/managing-users-identities">Managing Users and Identities</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/sign-in-with-github-google-facebook-linkedin">Sign in with GitHub, GitLab, Google, Facebook, LinkedIn, Microsoft ...</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/login-session">Configuring And Checking for Login Sessions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/configuring-cookies">Configuring Cookies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/setting-up-cors">Setting up Cross-origin resource sharing (CORS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/account-recovery-password-reset">Setting up Account Recovery and Password Reset</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/account-activation-email-verification">Setting up Account Activation and E-Mail Verification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/zero-trust-iap-proxy-identity-access-proxy">Zero Trust with IAP Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/multi-tenancy-multitenant">Multitenancy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/secret-key-rotation">Secret and Key Rotation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/high-availability-ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/docker">Docker Images</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/guides/setting-up-password-hashing-parameters">Setting up Password Hashing Parameters</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/reference/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/reference/json-schema-json-paths">JSON Schema and JSON Paths</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/reference/html-forms">HTML Form Parser</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/reference/api">REST API</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Command Line Interface (CLI)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos">kratos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers">kratos hashers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers-argon2">kratos hashers argon2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers-argon2-calibrate">kratos hashers argon2 calibrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities">kratos identities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-delete">kratos identities delete</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-get">kratos identities get</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-import">kratos identities import</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-list">kratos identities list</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-patch">kratos identities patch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-validate">kratos identities validate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet">kratos jsonnet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet-format">kratos jsonnet format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet-lint">kratos jsonnet lint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-migrate">kratos migrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-migrate-sql">kratos migrate sql</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote">kratos remote</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote-status">kratos remote status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote-version">kratos remote version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-serve">kratos serve</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-version">kratos version</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Debug &amp; Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/debug/csrf">Common Cookie and CSRF Pitfalls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/debug/performance-out-of-memory-password-hashing-argon2">Performance Problems and Out Of Memory Panics Caused by Password Hashing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SDKs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/sdk">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/milestones">Milestones and Roadmap</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Further Reading</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/further-reading/comparison">Comparison</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/further-reading/kratos-video-tutorials">Video Tutorials</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Hydra</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/hydra" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/hydra/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/hydra" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Oathkeeper</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Keto</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/keto" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/keto/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/keto" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for ORY Kratos <strong>Next</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/kratos/docs/concepts/security">latest version</a></strong> (v0.5).</div></div><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_1Lrw">Threat Models and Security Profiles</h1></header><div class="markdown"><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Please be aware that this chapter is still work in progress. Not all mitigation
strategies have been implemented yet in ORY Kratos!</p></div></div><p>Running any software that stores personal information exposes the
developer/company to risks. Analyzing which threat agents pose a risk,
understanding the possible motivations for an attack, or why an agent is a
threat, knowing the attack surface, the likelihood, and the impact are important
all aspects of a threat model.</p><p>This documentation can not substitute a thorough and serious threat model, yet
it will provide some guidelines to help configure ORY Kratos in a way that makes
it best suited for any risk assessment.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="account-enumeration-attacks"></a>Account Enumeration Attacks<a aria-hidden="true" tabindex="-1" class="hash-link" href="#account-enumeration-attacks" title="Direct link to heading">#</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This feature is a work in progress and is tracked as
<a href="https://github.com/ory/kratos/issues/133" target="_blank" rel="noopener noreferrer">kratos#133</a>.</p><p>It does not yet work as documented!</p></div></div><blockquote><p>&quot;Often, web applications reveal when a username exists on system, either as a
consequence of a misconfiguration or as a design decision. For example,
sometimes, when we submit wrong credentials, we receive a message that states
that either the username is present on the system or the provided password is
wrong. The information obtained can be used by an attacker to gain a list of
users on system. This information can be used to attack the web application,
for example, through a brute force or default username/password attack.
Description of the Issue&quot;</p><p><a href="https://wiki.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)" target="_blank" rel="noopener noreferrer">Source</a></p></blockquote><p>Considering the above, an example would be for example an adult website. A
threat agent wants to blackmail a well known politician by checking if someone
can sign up at that website using the <code>well-known-politician@email.com</code> email.</p><p>If the service responds with
<code>Sorry, that email is already signed up here. Did you try to log in instead?</code>,
the agent is able to proceed with some type of blackmail scheme.</p><p><a href="https://wiki.owasp.org/index.php/Testing_for_User_Enumeration_and_Guessable_User_Account_(OWASP-AT-002)#Black_Box_testing_and_example" target="_blank" rel="noopener noreferrer">OWASP defines several Black-Box tests</a>
that cover Account Enumeration Scenarios.</p><p>This attack usually makes only sense if an email address or a phone number is
collected during registration. For chosen usernames, this attack is much more
difficult, as the attacker has to know what usernames the victim is using.</p><p>There are three common ways an attacker can figure out if a user is signed up at
a service:</p><ul><li>During login: &quot;No user with this email address was found&quot;</li><li>During registration or email update: &quot;A user with this email address exists
already&quot;</li><li>During password reset: &quot;No user with this email address was found&quot;</li></ul><p>To mitigate this attack, the following methods need to be deployed:</p><ul><li>The login form should return the same message regardless of whether the
password is wrong or the email/username does not exist: &quot;The provided
credentials are invalid.&quot;</li><li>The password reset form should always return a success message and send out an
email. If the email address is registered, a normal password reset email is
sent. If the email address is not registered, an email is sent to the address
indicating that no account is set up with that email address. This is helpful
to users that have multiple email addresses and are using the wrong email
address for the password reset.</li><li>The registration form should also always return a success message and send out
an email. If the email address is not yet registered, a regular &quot;account
activation&quot; email is sent out. If the email address is registered already, a
email is sent out telling the user that the account is already set up, and
link to the login screen.</li></ul><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</h5></div><div class="admonition-content"><p>If you wish to mitigate account enumeration attacks, it is important to note
that you cannot sign in users directly after sign up! Depending on the type of
service you provide, you might not care about this specific attack in which case
direct login after sign up would be ok.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="enabling-account-enumeration-defenses"></a>Enabling Account Enumeration Defenses<a aria-hidden="true" tabindex="-1" class="hash-link" href="#enabling-account-enumeration-defenses" title="Direct link to heading">#</a></h3><p>Assuming you wish to enable account enumeration defenses, you need to configure
ORY Kratos as follows:</p><ul><li>Collect one or more email addresses during sign up and enable email
verification.</li><li><strong>Do not</strong> enable the <code>session</code> post-registration workflow.</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">selfservice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">flows</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">verification</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="defending-against-account-enumeration-when-using-openid-connect"></a>Defending Against Account Enumeration when using OpenID Connect<a aria-hidden="true" tabindex="-1" class="hash-link" href="#defending-against-account-enumeration-when-using-openid-connect" title="Direct link to heading">#</a></h4><p>Scenario: In some cases you might want to use the email address returned by e.g.
the GitHub profile to be added to your identity&#x27;s account. You might also want
to use it as an email + password identifier so that the identity is able to log
in with a password as well. An attacker is able to exploit that by creating a
social profile on another site (e.g. Google) and use the victims email address
to set it up (this only works when the victim does not yet have an account with
that email at Google). The attacker can then use that &quot;spoofed&quot; social profile
to try and sign up with your ORY Kratos installation. Because the victim&#x27;s email
address is already known to ORY Kratos, the attacker might be able to observe
the behavior (e.g. seeing an error page) and come to the conclusion that the
victim already has an account at the website.</p><p>Mitigation: This attack surface is rather small and requires a lot of effort,
including forging an e.g. Google profile, and can fail at several stages. To
completely mitigate any chance of that happening, only accept email addresses
that are marked as verified in your Jsonnet code:</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">contrib/quickstart/kratos/email-password/oidc.github.jsonnet</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local claims = </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  email_verified</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  identity</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    traits</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Therefore we only return the email if it (a) exists and (b) is marked verified</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// by GitHub.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">if </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;email_primary&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> claims.email_primary</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="disabling-account-enumeration-defenses"></a>Disabling Account Enumeration Defenses<a aria-hidden="true" tabindex="-1" class="hash-link" href="#disabling-account-enumeration-defenses" title="Direct link to heading">#</a></h3><p>Enforcing email verification, which requires an email round trip and disrupts
the sign up process, is not always feasible. In these cases, you might want to
disable account enumeration defenses.</p><p>If you enable the <code>session</code> post-registration workflow - signing the user in
directly after registration - disables account enumeration defenses:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">selfservice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">flows</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">registration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">after</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">hook</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> session</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="account-takeover-defenses"></a>Account Takeover Defenses<a aria-hidden="true" tabindex="-1" class="hash-link" href="#account-takeover-defenses" title="Direct link to heading">#</a></h2><p>The Settings Flow implements account takeover defenses as it is not possible to
change the password without knowing the existing password. A good example of
this flow is the
<a href="https://help.github.com/en/github/authenticating-to-github/sudo-mode" target="_blank" rel="noopener noreferrer">GitHub sudo mode</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="passwords"></a>Passwords<a aria-hidden="true" tabindex="-1" class="hash-link" href="#passwords" title="Direct link to heading">#</a></h2><p>Password-based authentication flows are subject to frequent abuse through</p><ul><li>Social Engineering Attacks;</li><li>Password Guessing Attacks;</li><li>Phishing Attacks.</li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Further improvements are work in progress and are tracked on
<a href="https://github.com/ory/kratos/issues?q=is%3Aopen+label%3Amodule%3Ass%2Fpassword+" target="_blank" rel="noopener noreferrer">GitHub</a></p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="expensive-hashing-with-argon2"></a>Expensive Hashing with Argon2<a aria-hidden="true" tabindex="-1" class="hash-link" href="#expensive-hashing-with-argon2" title="Direct link to heading">#</a></h3><p>ORY Kratos uses Argon2 for password hashing. Argon2 is the official winner of
the PHC 2017. You can tweak the Argon2 configuration in your ORY Kratos
configuration file:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">hashers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">argon2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1048576</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">iterations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">parallelism</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">salt_length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">key_length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">32</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="password-policy"></a>Password Policy<a aria-hidden="true" tabindex="-1" class="hash-link" href="#password-policy" title="Direct link to heading">#</a></h3><p>To prevent weak passwords ORY Kratos implements different measures. Users often
choose passwords similar to their traits. To prevent this ORY Kratos ensures
there is a sufficient
<a href="https://en.wikipedia.org/wiki/Levenshtein_distance" target="_blank" rel="noopener noreferrer">Levenshtein-Distance</a> (aka
&quot;Edit-Distance&quot;) between the identifier and the password. It also makes sure
that the identifier and password have a small enough longest common substring.</p><p>Furthermore the <code>password</code> method comes with a build-in check against the
<a href="https://haveibeenpwned.com" target="_blank" rel="noopener noreferrer">&quot;Have I been pwned&quot;</a> breach database. This way ORY
Kratos makes sure your users cannot use passwords like &quot;password&quot;, &quot;123456&quot; or
any other commonly used one. To protect the value of the password the
<a href="https://haveibeenpwned.com/API/v3#SearchingPwnedPasswordsByRange" target="_blank" rel="noopener noreferrer">range API</a> is
being used.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="password-policy-best-practices"></a>Password Policy Best Practices<a aria-hidden="true" tabindex="-1" class="hash-link" href="#password-policy-best-practices" title="Direct link to heading">#</a></h4><p>Almost every service with a login offers some type of registration using a
password. Therefore, there are many strategies floating around, with many of
them implementing terrible and insecure patterns such as:</p><ul><li>Not allowing special characters in passwords.</li><li>Not allowing the use of password managers by disabling the &quot;paste&quot;
functionality in password fields.</li><li>Requiring you to rotate your password every month (passwords expire).</li><li>...</li></ul><p>Troy Hunt has written an
<a href="https://www.troyhunt.com/passwords-evolved-authentication-guidance-for-the-modern-era/" target="_blank" rel="noopener noreferrer">excellent piece on password policies</a>
and why they recently changed and how.</p><p>ORY Kratos implements a password policy that:</p><ul><li>Checks if a password has previously been leaked using the
<a href="https://haveibeenpwned.com/API/v2" target="_blank" rel="noopener noreferrer">HIBP API</a>,</li><li>Checks if a password is too similar to one of the identifiers (in a future
release <a href="https://github.com/ory/kratos/issues/184" target="_blank" rel="noopener noreferrer">kratos#184</a>),</li><li>Makes passwords not expire.</li></ul><p>This is a rundown of all the practices ORY Kratos implements and why. <strong>Some
things need to be implemented by yourself</strong> as they must be implemented in the
User Interface that interfaces with ORY Kratos. You can find these in section
<a href="#user-interface-guidelines">User Interface Guidelines</a>.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="password-complexity"></a>Password Complexity<a aria-hidden="true" tabindex="-1" class="hash-link" href="#password-complexity" title="Direct link to heading">#</a></h5><p>This outline and quotes are defined in the
<a href="https://pages.nist.gov/800-63-3/sp800-63b.html" target="_blank" rel="noopener noreferrer">NIST Digital Identity Guidelines - 5.1.1.2 Memorized Secret Verifiers</a>.
ORY Kratos, unless explicitly advertised, implements these guidelines and best
practices.</p><p>Passwords must have a minimum length of 8 characters and all characters
(unicode, ASCII) must be allowed:</p><blockquote><p>Verifiers SHALL require subscriber-chosen memorized secrets to be at least 8
characters in length. Verifiers SHOULD permit subscriber-chosen memorized
secrets at least 64 characters in length. All printing ASCII [RFC 20]
characters as well as the space character SHOULD be acceptable in memorized
secrets. Unicode [ISO/ISC 10646] characters SHOULD be accepted as well. To
make allowances for likely mistyping, verifiers MAY replace multiple
consecutive space characters with a single space character prior to
verification, provided that the result is at least 8 characters in length.
Truncation of the secret SHALL NOT be performed. For purposes of the above
length requirements, each Unicode code point SHALL be counted as a single
character.</p></blockquote><p>Passwords must be checked against a database of compromised secrets such as
<a href="https://haveibeenpwned.com" target="_blank" rel="noopener noreferrer">Have I Been Pwnd</a>:</p><blockquote><p>When processing requests to establish and change memorized secrets, verifiers
SHALL compare the prospective secrets against a list that contains values
known to be commonly-used, expected, or compromised. For example, the list MAY
include, but is not limited to:</p><ul><li>Passwords obtained from previous breach corpuses.</li><li>Dictionary words.</li><li>Repetitive or sequential characters (e.g. â€˜aaaaaaâ€™, â€˜1234abcdâ€™).</li><li>Context-specific words, such as the name of the service, the username, and
derivatives thereof.</li></ul><p>If the chosen secret is found in the list, the CSP or verifier SHALL advise
the subscriber that they need to select a different secret, SHALL provide the
reason for rejection, and SHALL require the subscriber to choose a different
value.</p></blockquote><p>Show the user a password-strength meter (to be implemented, see
<a href="https://github.com/ory/kratos/issues/136" target="_blank" rel="noopener noreferrer">#136</a>):</p><blockquote><p>Verifiers SHOULD offer guidance to the subscriber, such as a password-strength
meter [Meters], to assist the user in choosing a strong memorized secret. This
is particularly important following the rejection of a memorized secret on the
above list as it discourages trivial modification of listed (and likely very
weak) memorized secrets</p></blockquote><p>Do not require mixtures of characters types or prohibiting repeated characters:</p><blockquote><p>Verifiers SHOULD NOT impose other composition rules (e.g., requiring mixtures
of different character types or prohibiting consecutively repeated characters)
for memorized secrets. Verifiers SHOULD NOT require memorized secrets to be
changed arbitrarily (e.g., periodically). However, verifiers SHALL force a
change if there is evidence of compromise of the authenticator.</p></blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="user-interface-guidelines"></a>User Interface Guidelines<a aria-hidden="true" tabindex="-1" class="hash-link" href="#user-interface-guidelines" title="Direct link to heading">#</a></h5><p>These best practices need to be implemented in your User Interface and can not
be handled by ORY Kratos. All ORY-built reference and demo applications
implement these best practices:</p><p>Allow pasting of passwords:</p><blockquote><p>Verifiers SHOULD permit claimants to use â€œpasteâ€ functionality when entering a
memorized secret. This facilitates the use of password managers, which are
widely used and in many cases increase the likelihood that users will choose
stronger memorized secrets.</p></blockquote><p>Allow the user to show the secret in the UI:</p><blockquote><p>In order to assist the claimant in successfully entering a memorized secret,
the verifier SHOULD offer an option to display the secret â€” rather than a
series of dots or asterisks â€” until it is entered. This allows the claimant to
verify their entry if they are in a location where their screen is unlikely to
be observed. The verifier MAY also permit the userâ€™s device to display
individual entered characters for a short time after each character is typed
to verify correct entry. This is particularly applicable on mobile devices.</p></blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="password-hints"></a>Password Hints<a aria-hidden="true" tabindex="-1" class="hash-link" href="#password-hints" title="Direct link to heading">#</a></h5><blockquote><p>Memorized secret verifiers SHALL NOT permit the subscriber to store a â€œhintâ€
that is accessible to an unauthenticated claimant.</p><p><a href="https://pages.nist.gov/800-63-3/sp800-63b.html" target="_blank" rel="noopener noreferrer">NIST Digital Identity Guidelines - 5.1.1.2 Memorized Secret Verifiers</a></p></blockquote><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="password-expiry"></a>Password Expiry<a aria-hidden="true" tabindex="-1" class="hash-link" href="#password-expiry" title="Direct link to heading">#</a></h5><blockquote><p>Forcing password expiry carries no real benefits because:</p><ul><li>the user is likely to choose new passwords that are only minor variations of
the old</li><li>stolen passwords are generally exploited immediately</li><li>resetting the password gives you no information about whether a compromise
has occurred</li><li>an attacker with access to the account will probably also receive the
request to reset the password</li><li>if compromised via insecure storage, the attacker will be able to find the
new password in the same place</li></ul><p><a href="https://www.ncsc.gov.uk/collection/passwords/updating-your-approach" target="_blank" rel="noopener noreferrer">NSCS Password administration for system owners</a></p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="anti-automation"></a>Anti-Automation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#anti-automation" title="Direct link to heading">#</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This feature is a work in progress and is tracked as
<a href="https://github.com/ory/kratos/issues/138" target="_blank" rel="noopener noreferrer">kratos#133</a>.</p></div></div><p>Actions that cause out-of-band communications, such as sending an activation
link via email or an activation code via SMS, can be abused by automated
systems. The goal of such an attack is to send out so many emails or SMS, that
your reputation worsens (spam filters) or you&#x27;re faced with massive costs
(carrier fees).</p><p>CAPTCHA renders these attacks either very difficult or impossible. ORY Kratos
has CAPTCHA support built-in. ORY Kratos will prompt the user to complete a
CAPTCHA in the following scenarios:</p><ul><li>The user tries to register more than one account within 72 hours.</li><li>The user failed provide valid credentials for the third time within 12 hours.</li><li>The user tries to recover their account for the second time within 72 hours.</li></ul><p>For integration guidelines, please check the individual flow&#x27;s (registration,
login, account recovery) integration documentation.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="bruteforce-attacks"></a>Bruteforce Attacks<a aria-hidden="true" tabindex="-1" class="hash-link" href="#bruteforce-attacks" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="phishing-attacks"></a>Phishing Attacks<a aria-hidden="true" tabindex="-1" class="hash-link" href="#phishing-attacks" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="social-engineering-attacks"></a>Social Engineering Attacks<a aria-hidden="true" tabindex="-1" class="hash-link" href="#social-engineering-attacks" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="sms-spoofing-attacks"></a>SMS Spoofing Attacks<a aria-hidden="true" tabindex="-1" class="hash-link" href="#sms-spoofing-attacks" title="Direct link to heading">#</a></h2><p>Will be addressed in a future release.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="account-enumeration"></a>Account Enumeration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#account-enumeration" title="Direct link to heading">#</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This feature is a work in progress and is tracked as
<a href="https://github.com/ory/kratos/issues/133" target="_blank" rel="noopener noreferrer">kratos#133</a>.</p><p>It does not yet work as documented!</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="digital-identity-guidelines"></a>Digital Identity Guidelines<a aria-hidden="true" tabindex="-1" class="hash-link" href="#digital-identity-guidelines" title="Direct link to heading">#</a></h2><p>There is no one standard to digital identity. ORY Kratos closely follows
emerging frameworks and guidelines such as:
<a href="https://pages.nist.gov/800-63-3/" target="_blank" rel="noopener noreferrer">Digital Identity Guidelines established by the National Institute of Standards and Technology (NIST)</a>
(and a follow-up <a href="https://pages.nist.gov/800-63-3/" target="_blank" rel="noopener noreferrer">FAQ</a>) .</p><p>As ORY Kratos grows, this document will continue to expand and add sections
covering individual security recommendations established by NIST.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ory/kratos/edit/master/docs/docs/concepts/security.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-09-13T12:59:10.000Z" class="docLastUpdatedAt_217_">9/13/2020</time> by <strong>aeneasr</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kratos/docs/next/concepts/federation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Federation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kratos/docs/next/self-service"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Self-Service Flows Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#account-enumeration-attacks" class="table-of-contents__link">Account Enumeration Attacks</a><ul><li><a href="#enabling-account-enumeration-defenses" class="table-of-contents__link">Enabling Account Enumeration Defenses</a></li><li><a href="#disabling-account-enumeration-defenses" class="table-of-contents__link">Disabling Account Enumeration Defenses</a></li></ul></li><li><a href="#account-takeover-defenses" class="table-of-contents__link">Account Takeover Defenses</a></li><li><a href="#passwords" class="table-of-contents__link">Passwords</a><ul><li><a href="#expensive-hashing-with-argon2" class="table-of-contents__link">Expensive Hashing with Argon2</a></li><li><a href="#password-policy" class="table-of-contents__link">Password Policy</a></li></ul></li><li><a href="#anti-automation" class="table-of-contents__link">Anti-Automation</a></li><li><a href="#bruteforce-attacks" class="table-of-contents__link">Bruteforce Attacks</a></li><li><a href="#phishing-attacks" class="table-of-contents__link">Phishing Attacks</a></li><li><a href="#social-engineering-attacks" class="table-of-contents__link">Social Engineering Attacks</a></li><li><a href="#sms-spoofing-attacks" class="table-of-contents__link">SMS Spoofing Attacks</a></li><li><a href="#account-enumeration" class="table-of-contents__link">Account Enumeration</a></li><li><a href="#digital-identity-guidelines" class="table-of-contents__link">Digital Identity Guidelines</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.ory.sh/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.ory.sh/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://www.ory.sh/tos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 ORY GmbH</div></div></div><div id="codefund"></div><script src="https://codefund.io/properties/140/funder.js" async=""></script><script>document.querySelectorAll(".tabs .tabs-nav .nav-item a").forEach((function(t){t.addEventListener("click",(function(e){return e.preventDefault(),t.closest(".tabs-nav").querySelectorAll(".nav-item a").forEach((function(t){t.classList.remove("active")})),t.closest(".tabs").querySelectorAll(".tab-content .tab-pane").forEach((function(t){t.classList.remove("active")})),t.classList.add("active"),document.getElementById(t.href.split("#")[1]).classList.add("active"),!1}))}))</script></footer></div>
<script src="/kratos/docs/styles.3afafc58.js"></script>
<script src="/kratos/docs/runtime~main.78d25836.js"></script>
<script src="/kratos/docs/main.350481f8.js"></script>
<script src="/kratos/docs/2.5656020f.js"></script>
<script src="/kratos/docs/3.2e356fd4.js"></script>
<script src="/kratos/docs/1be78505.78c61d1d.js"></script>
<script src="/kratos/docs/b8d7c5e6.335c2cf6.js"></script>
<script src="/kratos/docs/367.30d1c7e4.js"></script>
<script src="/kratos/docs/366.974e634b.js"></script>
<script src="/kratos/docs/935f2afb.ddb06975.js"></script>
<script src="/kratos/docs/17896441.27be24ed.js"></script>
<script src="/kratos/docs/a34feefc.b1d9beaa.js"></script>
</body>
</html>