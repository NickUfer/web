<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.56">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-71865250-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="ORY Kratos" href="/kratos/docs/opensearch.xml"><title data-react-helmet="true">Social Sign In with OpenID Connect and OAuth2 | ORY Kratos</title><meta data-react-helmet="true" name="docsearch:version" content="v0.3"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Social Sign In with OpenID Connect and OAuth2 | ORY Kratos"><meta data-react-helmet="true" name="description" content="Please read the"><meta data-react-helmet="true" property="og:description" content="Please read the"><meta data-react-helmet="true" property="og:url" content="https://www.ory.sh//kratos/docs/self-service/flows/user-login-user-registration/openid-connect-social-sign-in-oauth2"><link data-react-helmet="true" rel="shortcut icon" href="/kratos/docs/img/favico.png"><link data-react-helmet="true" rel="canonical" href="https://www.ory.sh//kratos/docs/self-service/flows/user-login-user-registration/openid-connect-social-sign-in-oauth2"><link rel="stylesheet" href="/kratos/docs/styles.540c99d3.css">
<link rel="preload" href="/kratos/docs/styles.89d9b080.js" as="script">
<link rel="preload" href="/kratos/docs/runtime~main.5ba6f007.js" as="script">
<link rel="preload" href="/kratos/docs/main.2bafbc44.js" as="script">
<link rel="preload" href="/kratos/docs/1.82890050.js" as="script">
<link rel="preload" href="/kratos/docs/2.e9695c35.js" as="script">
<link rel="preload" href="/kratos/docs/18b93cb3.9f32eb3f.js" as="script">
<link rel="preload" href="/kratos/docs/1be78505.bf6d13e7.js" as="script">
<link rel="preload" href="/kratos/docs/f9e517e8.11d8b451.js" as="script">
<link rel="preload" href="/kratos/docs/191.c7f6dbd8.js" as="script">
<link rel="preload" href="/kratos/docs/190.a91a1f81.js" as="script">
<link rel="preload" href="/kratos/docs/a7f4b2b8.157c2b34.js" as="script">
<link rel="preload" href="/kratos/docs/98e46ddd.255463aa.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand" to="https://www.ory.sh/kratos"><img class="navbar__logo" src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos"></a><a class="navbar__item navbar__link" href="/kratos/docs/index">Docs</a><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Ecosystem</a><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://community.ory.sh" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Forum</a><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chat</a><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/kratos/docs/versions">v0.3</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><div class="searchWrapper_-F3-"><span aria-label="expand searchbar" role="button" class="searchIconButton_1Dnz" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_2eto"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand" to="https://www.ory.sh/kratos"><img class="navbar__logo" src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/index">Docs</a></li><li class="menu__list-item"><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="menu__link">Ecosystem</a></li><li class="menu__list-item"><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://community.ory.sh" target="_blank" rel="noopener noreferrer" class="menu__link">Forum</a></li><li class="menu__list-item"><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="menu__link">Chat</a></li><li class="menu__list-item"><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/versions">v0.3</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/index">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/install">Installation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/index">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/ui-user-interface">User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/identity-user-model">Identity Data Model</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Identity Credentials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/credentials">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/credentials/username-email-password">Username / Email &amp; Password</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/credentials/openid-connect-oidc-oauth2">Social Sign In, OpenID Connect, and OAuth2</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/selfservice-flow-completion">Self-Service Flow Completion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/federation">Federation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/concepts/security">Threat Models and Security Profiles</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Self Service</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service">Before you start reading</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">User Login and User Registration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service/flows/user-login-user-registration">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service/flows/user-login-user-registration/username-email-password">Username or Email and Password</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/kratos/docs/self-service/flows/user-login-user-registration/openid-connect-social-sign-in-oauth2">Social Sign In with OpenID Connect and OAuth2</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">User Settings</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/self-service/flows/user-settings">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/self-service/flows/user-settings/user-profile-management">User Profile Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/self-service/flows/user-settings/change-password">Change Password</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/self-service/flows/user-settings/link-unlink-openid-connect-oauth2">Link and Unlink OpenID Connect and OAuth2 Connections</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service/flows/user-logout">User Logout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service/flows/password-reset-account-recovery">Account Recovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service/flows/user-facing-errors">User-Facing Errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service/flows/verify-email-account-activation">Email and Phone Verification and Account Activation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service/flows/2fa-mfa-multi-factor-authentication">MFA / 2FA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/self-service/hooks/index">Hooks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/guides/sign-in-with-github-google-facebook-linkedin">Sign in with GitHub, Google, Facebook, LinkedIn, Microsoft ...</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/guides/zero-trust-iap-proxy-identity-access-proxy">Zero Trust with IAP Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/guides/multi-tenancy-multitenant">Multitenancy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/guides/high-availability-ha">High Availability</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/reference/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/reference/json-schema-json-paths">JSON Schema and JSON Paths</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/reference/html-forms">HTML Form Parser</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/reference/api">REST API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Debug &amp; Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/debug/csrf">Common Cookie and CSRF Pitfalls</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SDKs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/sdk">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Further Reading</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/further-reading/comparison">Comparison</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Hydra</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/hydra" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/hydra" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/hydra/docs" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/hydra/docs" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/hydra" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://github.com/ory/hydra" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Oathkeeper</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/oathkeeper" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper/docs" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/oathkeeper/docs" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://github.com/ory/oathkeeper" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Keto</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/keto" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/keto" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/keto/docs" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/keto/docs" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/keto" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://github.com/ory/keto" tabindex="-1">GitHub</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><div><span class="badge badge--secondary">Version: v0.3</span></div><header><h1 class="docTitle_1vWb">Social Sign In with OpenID Connect and OAuth2</h1></header><div class="markdown"><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Before you start</h5></div><div class="admonition-content"><p>Please read the
<a href="/kratos/docs/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect / OAuth2 Credentials Documentation</a>
and <a href="../identity-login-identity-registration.mdx">identity Login and Registration Documentation</a> first.</p></div></div><p>The Social Sign In Strategy enables you to use</p><ul><li><a href="http://github.com/" target="_blank" rel="noopener noreferrer">GitHub</a>;</li><li><a href="https://developer.apple.com/sign-in-with-apple/" target="_blank" rel="noopener noreferrer">Apple</a>;</li><li><a href="https://developers.google.com/identity/sign-in/web/sign-in" target="_blank" rel="noopener noreferrer">Google</a>;</li><li><a href="https://developers.facebook.com/docs/facebook-login/" target="_blank" rel="noopener noreferrer">Facebook</a>;</li><li><a href="https://www.ory.sh/hydra" target="_blank" rel="noopener noreferrer">ORY Hydra</a>;</li><li><a href="https://www.keycloak.org">Keycloak</a>;</li><li>and every other OpenID Connect Certified Provider</li></ul><p>as the Identity Provider.  It implements several flows, specifically
<a href="../identity-login-identity-registration.mdx">identity Login and identity Registration</a>
and <a href="../identity-settings.mdx">identity Settings</a>.</p><p>Because OAuth2 and OpenID Connect (OIDC) require the identity to interact with a browser,
this strategy does not work with API-only flows. You cannot log in or sign up a identity
using this strategy</p><ul><li>with REST API or AJAX requests only;</li><li>without a browser.</li></ul><p>This document summarizes exemplary request payloads for performing &quot;Sign in with ...&quot; flows
using the identity login and registration flow with the <code>oidc</code> strategy.</p><p>ORY Kratos automatically converts registration to login flows and vice versa. A user
that&#x27;s already signed up with his/her Google account will be logged in even if you
initiate a registration request.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>It is very important to add the &quot;session&quot; hook to the after oidc registration
hooks. Otherwise your users need to use the login flow again to be able to get a
session.</p><div class="mdxCodeBlock_iHAB"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_U1PS">path/to/my/kratos/config.yml</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">selfservice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">registration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">after</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">oidc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">hooks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">hook</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> session</span></div></div></div></div></div></div></div><p>Here we use a configuration with 3 providers:</p><div class="mdxCodeBlock_iHAB"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_U1PS">path/to/my/kratos/config.yml</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">selfservice</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">strategies</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">oidc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">providers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> hydra</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># provider, client_id, issuer_url, scope, ...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> google</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># provider, client_id, issuer_url, scope, ...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> github</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># provider, client_id, issuer_url, scope, ...</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="registration"></a>Registration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#registration" title="Direct link to heading">#</a></h2><p>Redirecting the browser to the <a href="/kratos/docs/self-service/flows/user-login-user-registration#user-login-and-user-registration-process-sequence">Self-Service Login and Registration Endpoint</a>
initiates the flow. If the <code>oidc</code> strategy is enabled and at least one provider is configued,
the Registration Request Response Payload will include an <code>oidc</code> method. The method contains different providers,
based on your OpenID Connect Provider configuration:</p><div class="mdxCodeBlock_iHAB"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_U1PS">$ curl http://&lt;kratos-admin&gt;/self-service/browser/flows/requests/registration?request=54a9f113-3a7b-4cb8-a553-f072aa4e1622</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-json5 codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;id&quot;: &quot;54a9f113-3a7b-4cb8-a553-f072aa4e1622&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;expires_at&quot;: &quot;2020-05-15T11:04:09.342537Z&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;issued_at&quot;: &quot;2020-05-15T10:04:09.342537Z&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;request_url&quot;: &quot;http://127.0.0.1:4433/self-service/browser/flows/registration&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;methods&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;oidc&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;method&quot;: &quot;oidc&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;config&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;action&quot;: &quot;http://127.0.0.1:4455/.ory/kratos/public/self-service/browser/flows/strategies/oidc/auth/54a9f113-3a7b-4cb8-a553-f072aa4e1622&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;method&quot;: &quot;POST&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;fields&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;csrf_token&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;hidden&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;required&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;J9blMEwxnz6cL7rgcpu1vthggR13RH+7YMS77GBPn9yo7FqPNc9tTsvCQhu7Cu8AAREWXZF2FiaPia26SfrPBA==&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;hydra&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;google&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;github&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;password&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;method&quot;: &quot;password&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;config&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;action&quot;: &quot;http://127.0.0.1:4455/.ory/kratos/public/self-service/browser/flows/registration/strategies/password?request=54a9f113-3a7b-4cb8-a553-f072aa4e1622&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;method&quot;: &quot;POST&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;fields&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;csrf_token&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;hidden&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;required&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;J9blMEwxnz6cL7rgcpu1vthggR13RH+7YMS77GBPn9yo7FqPNc9tTsvCQhu7Cu8AAREWXZF2FiaPia26SfrPBA==&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;password&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;password&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;required&quot;: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;traits.email&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;email&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;traits.website&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;url&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>The next step depends on your Identity Traits JSON Schema and your JsonNet code. We&#x27;re using the following
in this example:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-jsonnet codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;$id&quot;: &quot;https://schemas.ory.sh/presets/kratos/quickstart/email-password/identity.schema.json&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;$schema&quot;: &quot;http://json-schema.org/draft-07/schema#&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;title&quot;: &quot;Person&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;type&quot;: &quot;object&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;properties&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;email&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;type&quot;: &quot;string&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;format&quot;: &quot;email&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;title&quot;: &quot;E-Mail&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;minLength&quot;: 3,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;ory.sh/kratos&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;credentials&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          &quot;password&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;identifier&quot;: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;website&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;type&quot;: &quot;string&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;format&quot;: &quot;uri&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;minLength&quot;: 10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;required&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;email&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;website&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;additionalProperties&quot;: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-jsonnet codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local claims = std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if std.length(claims.sub) == 0 then</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  error &#x27;claim sub not set&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    identity: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      traits: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        email: claims.sub,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [if &quot;website&quot; in claims then &quot;website&quot; else null]: claims.website,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div></div></div><p>This implies that the identity has a required attributes <code>email</code> and <code>website</code>. When singing in using Google,
we take the <code>sub</code> and <code>website</code> claim are used to hydrate these fields. If they&#x27;re missing or invalid (because e.g. not an
email, the user
returns to the registration form with additional fields that need to be filled out. Please note that these claims
are just examples, Google doesn&#x27;t actually use email addresses in <code>sub</code> fields and also does not include the <code>website</code>
claim:</p><div class="mdxCodeBlock_iHAB"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_U1PS">$ curl http://&lt;kratos-admin&gt;/self-service/browser/flows/requests/registration?request=54a9f113-3a7b-4cb8-a553-f072aa4e1622</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-json5 codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;id&quot;: &quot;54a9f113-3a7b-4cb8-a553-f072aa4e1622&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;active&quot;: &quot;oidc&quot;, // &lt;-- this is now set</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;methods&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;oidc&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;method&quot;: &quot;oidc&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;config&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;action&quot;: &quot;http://127.0.0.1:4455/.ory/kratos/public/self-service/browser/flows/strategies/oidc/auth/54a9f113-3a7b-4cb8-a553-f072aa4e1622&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;method&quot;: &quot;POST&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // Errors can be included here, for example:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // &quot;errors&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                //     {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                //         &quot;message&quot;: &quot;Authentication failed because no id_token was returned. Please accept the \&quot;openid\&quot; permission and try again.&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                //     }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                // ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;fields&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;csrf_token&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;hidden&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;required&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;A84oYSplXqtJTkhSipZc/2+tFXCN2gzWAfhmoK049FKM9JfeU5us2x6jsKlDBwZBttyCMGvoZUvutXD2hI2kig==&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;traits.email&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;text&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;superuser@ory.sh&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;traits.website&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;errors&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                &quot;message&quot;: &quot;missing properties: \&quot;website\&quot;&quot; // &lt;-- because &quot;website&quot; was not set, the user has to fill it out manually.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;google&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="login"></a>Login<a aria-hidden="true" tabindex="-1" class="hash-link" href="#login" title="Direct link to heading">#</a></h2><p>Redirecting the browser to the <a href="/kratos/docs/self-service/flows/user-login-user-registration#user-login-and-user-registration-process-sequence">Self-Service Login and Registration Endpoint</a>
initiates the flow. If the <code>oidc</code> strategy is enabled and at least one provider is configued,
the Login Request Response Payload will include an <code>oidc</code> method. The method contains different providers,
based on your OpenID Connect Provider configuration:</p><div class="mdxCodeBlock_iHAB"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_U1PS">$ curl http://&lt;kratos-admin&gt;/self-service/browser/flows/requests/login?request=a1c78949-1436-44bd-93ae-a57836be01c7</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-json5 codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;id&quot;: &quot;a1c78949-1436-44bd-93ae-a57836be01c7&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;expires_at&quot;: &quot;2020-05-15T10:49:58.770828Z&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;issued_at&quot;: &quot;2020-05-15T09:49:58.770829Z&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;request_url&quot;: &quot;http://127.0.0.1:4433/self-service/browser/flows/login&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;methods&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // password: ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;oidc&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;method&quot;: &quot;oidc&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;config&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;action&quot;: &quot;http://127.0.0.1:4455/.ory/kratos/public/self-service/browser/flows/strategies/oidc/auth/a1c78949-1436-44bd-93ae-a57836be01c7&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;method&quot;: &quot;POST&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;fields&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;csrf_token&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;hidden&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;required&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;/Q85ogDm+Hv7D+ca7DUXYBRqmkTdMiIzXrZxt8IXgFHd7rkc8+U1WoWNmScDfJ8/cEju/hUIko5N48GR3rMfag==&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;hydra&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;google&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;github&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;forced&quot;: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>The only form validation error that can happen during this flow is that the ID Token is missing
because the user did not authorize the <code>openid</code> grant (does not apply for <code>provider: github</code>):</p><div class="mdxCodeBlock_iHAB"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_U1PS">$ curl http://&lt;kratos-admin&gt;/self-service/browser/flows/requests/login?request=a1c78949-1436-44bd-93ae-a57836be01c7</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-json5 codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;id&quot;: &quot;a1c78949-1436-44bd-93ae-a57836be01c7&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // expires_at, ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;active&quot;: &quot;oidc&quot;, // &lt;- this is now set!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;methods&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // password: ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;oidc&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;method&quot;: &quot;oidc&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;config&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;action&quot;: &quot;http://127.0.0.1:4455/.ory/kratos/public/self-service/browser/flows/strategies/oidc/auth/a1c78949-1436-44bd-93ae-a57836be01c7&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;method&quot;: &quot;POST&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;errors&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;message&quot;: &quot;Authentication failed because no id_token was returned. Please accept the \&quot;openid\&quot; permission and try again.&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;fields&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;csrf_token&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;hidden&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;required&quot;: true,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;viM0pQKXUIthwPklREm/86pdIg3d8CWJOzGOiHtrCW4xGYsae2mi+zYtAd6N2OVNcyy1TTvCTBTUfJjeUt5Ztg==&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;hydra&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;google&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;name&quot;: &quot;provider&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;type&quot;: &quot;submit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;value&quot;: &quot;github&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                ]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;forced&quot;: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>The flow completes otherwise.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="security-and-defenses"></a>Security and Defenses<a aria-hidden="true" tabindex="-1" class="hash-link" href="#security-and-defenses" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="account-enumeration"></a>Account Enumeration<a aria-hidden="true" tabindex="-1" class="hash-link" href="#account-enumeration" title="Direct link to heading">#</a></h3><p>Scenario: In some cases you might want to use the email address returned by e.g.
the GitHub profile to be added to your identity&#x27;s account. You might also want to use
it as an email + password identifier so that the identity is able to log in
with a password as well. An attacker is able to exploit that by creating a social
profile on another site (e.g. Google) and use the victims email address to set it up
(this only works when the victim does not yet have an account with that email at Google).
The attacker can then use that &quot;spoofed&quot; social profile to try and sign up with your ORY Kratos
installation. Because the victim&#x27;s email address is already known to ORY Kratos, the
attacker might be able to observe the behavior (e.g. seeing an error page) and come
to the conclusion that the victim already has an account at the website.</p><p>Mitigation: This attack surface is rather small and requires a lot of effort, including
forging an e.g. Google profile, and can fail at several stages. To completely mitigate
any chance of that happening, only accept email addresses that are marked as verified
in your Jsonnet code:</p><div class="mdxCodeBlock_iHAB"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_U1PS">contrib/quickstart/kratos/email-password/oidc.github.jsonnet</div><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj undefined">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_19pQ codeBlockWithTitle_2fj3"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">local claims = </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  email_verified</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  identity</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    traits</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Therefore we only return the email if it (a) exists and (b) is marked verified</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// by GitHub.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">if </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;email_primary&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> claims.email_primary</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ory/kratos/edit/master/docs/versioned_docs/version-v0.3/self-service/flows/user-login-user-registration/openid-connect-social-sign-in-oauth2.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-05-15T13:20:40.000Z" class="docLastUpdatedAt_1sqk">5/15/2020</time> by <strong>aeneasr</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kratos/docs/self-service/flows/user-login-user-registration/username-email-password"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label"> Username or Email and Password</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kratos/docs/self-service/flows/user-settings"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">User Settings </div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#registration" class="table-of-contents__link">Registration</a></li><li><a href="#login" class="table-of-contents__link">Login</a></li><li><a href="#security-and-defenses" class="table-of-contents__link">Security and Defenses</a><ul><li><a href="#account-enumeration" class="table-of-contents__link">Account Enumeration</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.ory.sh/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.ory.sh/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://www.ory.sh/tos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div>Copyright  2020 ORY GmbH</div></div></div><div id="codefund"></div><script src="https://codefund.io/properties/140/funder.js" async=""></script><script>document.querySelectorAll(".tabs .tabs-nav .nav-item a").forEach((function(t){t.addEventListener("click",(function(e){return e.preventDefault(),t.closest(".tabs-nav").querySelectorAll(".nav-item a").forEach((function(t){t.classList.remove("active")})),t.closest(".tabs").querySelectorAll(".tab-content .tab-pane").forEach((function(t){t.classList.remove("active")})),t.classList.add("active"),document.getElementById(t.href.split("#")[1]).classList.add("active"),!1}))}))</script></footer></div>
<script src="/kratos/docs/styles.89d9b080.js"></script>
<script src="/kratos/docs/runtime~main.5ba6f007.js"></script>
<script src="/kratos/docs/main.2bafbc44.js"></script>
<script src="/kratos/docs/1.82890050.js"></script>
<script src="/kratos/docs/2.e9695c35.js"></script>
<script src="/kratos/docs/18b93cb3.9f32eb3f.js"></script>
<script src="/kratos/docs/1be78505.bf6d13e7.js"></script>
<script src="/kratos/docs/f9e517e8.11d8b451.js"></script>
<script src="/kratos/docs/191.c7f6dbd8.js"></script>
<script src="/kratos/docs/190.a91a1f81.js"></script>
<script src="/kratos/docs/a7f4b2b8.157c2b34.js"></script>
<script src="/kratos/docs/98e46ddd.255463aa.js"></script>
</body>
</html>